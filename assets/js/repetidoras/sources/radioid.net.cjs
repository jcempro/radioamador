async function processarRegistro(o,s){const{state:e,country:t,status:r,city:i,map_info:n,map:a,locator:c,trustee:l,...d}=o;if(!/bra(s|z)il/i.test((t||"").trim())||"active"!==(r||"").toLowerCase())return null;const p=radioUTILs.normalizarEstado(e);if(!p)return null;const f=await radioUTILs.processarNomeCidade(i,p);if(!f)return null;["frequency","offset","color_code","id"].forEach(o=>{null!=d[o]&&(d[o]=parseFloat(d[o])||0)}),d.info={},void 0!==d.frequency&&(d.rx=d.frequency,delete d.frequency),void 0!==d.color_code&&(d.color=d.color_code,delete d.color_code),void 0!==d.ts_linked&&(d.timeslot=converterTimeslot(d.ts_linked),delete d.ts_linked),void 0!==d.id&&(d.info.dmr_id=d.id,delete d.id),void 0!==d.ipsc_network&&(d.info.ipsc=d.ipsc_network,delete d.ipsc_network),void 0!==d.assigned&&(d.info.assigned=d.assigned,delete d.assigned),void 0!==d.callsign&&(d.info.callsign=d.callsign,delete d.callsign),void 0!==d.rx&&void 0!==d.offset&&(d.tx=parseFloat((d.rx+d.offset).toFixed(5)));const u=`${p}:${f}`;return s[u]=(s[u]||0)+1,d.location=[p.toUpperCase(),f],Object.keys(d).forEach(o=>{"string"==typeof d[o]&&"location"!==o&&(d[o]=commom.capitalizar(d[o]))}),{estadoSigla:p,registro:d}}async function processarJSON(o,s,e,t=null,r=[PATH_FILE,__RPTDR_LNK],i="radioid.net"){try{const n=await s(r,i);if("object"!=typeof n||!Array.isArray(n?.rptrs))throw new Error("JSON invÃ¡lido. Esperado objeto com '.rptrs'");const a={},c={},l={totalEstados:0,totalRegistros:0,registrosOriginais:n.rptrs.length,arquivosGerados:[],estadosProcessados:[],contents:{}};for(const o of n.rptrs){const s=await processarRegistro(o,c);if(s){const{estadoSigla:o,registro:e}=s;a[o]||(a[o]=[]),a[o].push(e)}}cacheProcessado=a;for(const[s,t]of Object.entries(a)){const r={};t.forEach(o=>{const e=o.location[1],t=`${s}:${e}`;r[t]=(r[t]||0)+1});const i={};t.forEach(o=>{const e=o.location[1],t=`${s}:${e}`;r[t]>1&&(i[t]=(i[t]||0)+1,o.location.push(i[t]))}),t.sort((o,s)=>o.location[1].localeCompare(s.location[1]));const n=o("",s),a=await e(t,n,s);l.contents[s]=t,l.totalEstados++,l.totalRegistros+=t.length,l.arquivosGerados.push(a),l.estadosProcessados.push(s),console.log(`Estado ${s.toUpperCase()}: ${t.length} registros`)}return console.log(`\nProcessado: ${l.totalEstados} estados, ${l.totalRegistros} registros (original: ${l.registrosOriginais})`),"function"==typeof t&&t(null,l),l}catch(o){throw console.error("Erro ao processar:",o),"function"==typeof t&&t(o,null),o}}const isNODE="undefined"==typeof window,commom=isNODE?require("../../common.main.cjs"):"undefined"!=typeof window?window.commom:globalThis.commom,radioUTILs=isNODE?require("../utils.main.cjs"):"undefined"!=typeof window?window.radioUtils:globalThis.radioUtils,__RPTDR_LNK="https://radioid.net/static/rptrs.json",PATH_FILE="rptrs.json";let cacheProcessado=null;const converterTimeslot=o=>o?o.replace(/TS/gi,"").trim().split(/\s+/).map(o=>parseInt(o,10)).filter(o=>!isNaN(o)&&o>0):[];isNODE&&(module.exports={processarJSON:processarJSON}),"undefined"!=typeof globalThis&&(globalThis.radioidnet={processarJSON:processarJSON},"undefined"!=typeof window&&(window.radioidnet=globalThis.radioModels));