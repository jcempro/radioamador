async function processarRegistro(o,s){const{state:e,country:t,status:i,city:r,map_info:a,map:n,locator:c,trustee:d,...l}=o;if(!/bra(s|z)il/i.test((t||"").trim())||"active"!==(i||"").toLowerCase())return null;const p=radioUTILs.normalizarEstado(e);if(!p)return null;const f=await radioUTILs.processarNomeCidade(r,p);if(!f)return null;["frequency","offset","color_code","id"].forEach(o=>{null!=l[o]&&(l[o]=parseFloat(l[o])||0)}),l.info={},void 0!==l.frequency&&(l.rx=l.frequency,delete l.frequency),void 0!==l.color_code&&(l.color=l.color_code,delete l.color_code),void 0!==l.ts_linked&&(l.timeslot=converterTimeslot(l.ts_linked),delete l.ts_linked),void 0!==l.id&&(l.info.dmr_id=l.id,delete l.id),void 0!==l.ipsc_network&&(l.info.ipsc=l.ipsc_network,delete l.ipsc_network),void 0!==l.assigned&&(l.info.assigned=l.assigned,delete l.assigned),void 0!==l.callsign&&(l.info.callsign=l.callsign,delete l.callsign),void 0!==l.rx&&void 0!==l.offset&&(l.tx=parseFloat((l.rx+l.offset).toFixed(5)));const u=`${p}:${f}`;return s[u]=(s[u]||0)+1,l.location=[p.toUpperCase(),f],Object.keys(l).forEach(o=>{"string"==typeof l[o]&&"location"!==o&&(l[o]=commom.capitalizar(l[o]))}),{estadoSigla:p,registro:l}}async function processarJSON(o,s,e,t=null,i=[PATH_FILE,__RPTDR_LNK],r="radioid.net"){try{const a=await s(i,r);if("object"!=typeof a||!Array.isArray(a?.rptrs))throw new Error("JSON invÃ¡lido. Esperado objeto com '.rptrs'");const n={},c={},d={totalEstados:0,totalRegistros:0,registrosOriginais:a.rptrs.length,arquivosGerados:[],estadosProcessados:[],contents:{}};for(const o of a.rptrs){const s=await processarRegistro(o,c);if(s){const{estadoSigla:o,registro:e}=s;n[o]||(n[o]=[]),n[o].push(e)}}cacheProcessado=n;for(const[s,t]of Object.entries(n)){const i={};t.forEach(o=>{const e=o.location[1],t=`${s}:${e}`;i[t]=(i[t]||0)+1});const r={};t.forEach(o=>{const e=o.location[1],t=`${s}:${e}`;i[t]>1&&(r[t]=(r[t]||0)+1,o.location.push(r[t]))}),t.sort((o,s)=>o.location[1].localeCompare(s.location[1]));const a=o("",s),n=await e(t,a,s);d.contents[s]=t,d.totalEstados++,d.totalRegistros+=t.length,d.arquivosGerados.push(n),d.estadosProcessados.push(s),console.log(`Estado ${s.toUpperCase()}: ${t.length} registros`)}return console.log(`\nProcessado: ${d.totalEstados} estados, ${d.totalRegistros} registros (original: ${d.registrosOriginais})`),"function"==typeof t&&t(null,d),d}catch(o){throw console.error("Erro ao processar:",o),"function"==typeof t&&t(o,null),o}}const isNODE="undefined"==typeof window,CIDADES=isNODE?require("../cidades.main.cjs"):"undefined"!=typeof window?window.cidades:globalThis.cidades,radioUTILs=isNODE?require("../utils.main.cjs"):"undefined"!=typeof window?window.radioUtils:globalThis.radioUtils,__RPTDR_LNK="https://radioid.net/static/rptrs.json",PATH_FILE="rptrs.json";let cacheProcessado=null;const converterTimeslot=o=>o?o.replace(/TS/gi,"").trim().split(/\s+/).map(o=>parseInt(o,10)).filter(o=>!isNaN(o)&&o>0):[];isNODE&&(module.exports={processarJSON:processarJSON}),"undefined"!=typeof globalThis&&(globalThis.radioidnet={processarJSON:processarJSON},"undefined"!=typeof window&&(window.radioidnet=globalThis.radioModels));