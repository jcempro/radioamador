function formatarFrequencia(o){return"number"!=typeof o||isNaN(o)?"0.00000":o.toFixed(5)}function processarTimeSlot(o){if(o.timeslot&&Array.isArray(o.timeslot))return o.timeslot;if(o.ts_linked){if("string"==typeof o.ts_linked)return o.ts_linked.includes("2")?[1,2]:[1];if(Array.isArray(o.ts_linked))return o.ts_linked}return[1]}function determinarValorAD(o){if(!Array.isArray(AD_CONFIG)||AD_CONFIG.length<2)return AD_CONFIG[0]||"A";const r=o.timeslot?.length>0,e=void 0!==o.color&&null!==o.color&&0!==o.color&&"0"!==o.color;return r&&e?AD_CONFIG[1]:AD_CONFIG[0]}function criarChAlias(o,r){if(!Array.isArray(o)||o.length<2)return"Unknown";const[e,n,t]=o,i={UF:e||"XX",CITY:n||"Unknown",COUNT:void 0!==t?t:"",AD:r||AD_CONFIG[0]};let a=CH_ALIAS_TEMPLATE;return a=a.replace(/\{\{\$([A-Z_]+)\}\}/g,(o,r)=>i[r]??o),a=a.replace(/\{\{\s*\[\s*([^}]+)\s*\]\s*\}\}/g,(o,r)=>/\{\{\$([A-Z_]+)\}\}/.test(r)&&r.match(/\{\{\$([A-Z_]+)\}\}/g).some(o=>""===i[o.replace(/\{\{\$([A-Z_]+)\}\}/,"$1")])?"":r),a.replace(/\s+/g," ").trim()}function converterRegistro(o,r){const e=processarTimeSlot(o),n=e.includes(2),t=determinarValorAD(o);let i=o.location||["XX","Unknown"];2===i.length&&i.push("");const a=criarChAlias(i,t),l=o.rx||0,s=o.tx||0,d=o.offset||s-l;return[r,formatarFrequencia(l),formatarFrequencia(s),"Digital","RX+TX","High",60,"Add",a,"Channel ID",`${o.info?.dmr_id||o.id||""}`,n?"On":"Off",e[0]||1,`${o.color_code||o.color||"1"}`,"Off","Allow TX","All Call","None","None","None","None","Normal",0,"Allow TX","FM","Off","Off","Wide",d.toFixed(5)]}function jsonToModel(o){if(!Array.isArray(o))throw new Error("Registros deve ser um array");const r=[];return o.forEach((o,e)=>{const n=e+1;r.push(converterRegistro(o,n))}),r}function modelToCSV(o){if(!Array.isArray(o)||0===o.length)throw new Error("Dados do modelo devem ser um array nÃ£o vazio");return[MODEL,...o].map(o=>o.map(o=>commom._ASPAS(o)).join(",")).join("\n")}function converterParaModelo(o,r=!1){let e;if("string"==typeof o)try{e=JSON.parse(o)}catch(o){throw new Error("Erro ao parsear JSON: "+o.message)}else{if(!Array.isArray(o))throw new Error("Dados devem ser array JSON ou string JSON");e=o}const n=jsonToModel(e);return r?modelToCSV(n):n}const isNODE="undefined"==typeof window,commom=isNODE?require("../../common.main.cjs"):"undefined"!=typeof window?window.commom:globalThis.commom,CH_ALIAS_TEMPLATE="{{$AD}}, {{$UF}}/{{$UF}}",AD_CONFIG=["A","D"],MODEL=["CH","RX Freq","TX Freq","CH Mode","RX/TX Limit","TX Power","TOT","Scan Add","CH Alias","ID Type","CH ID","Dual Slot","Time Slot","Color Code","Promiscuous","TX Politely","TX Contacts","RX TG List","DMR Encryption","RX CTC DCS","TX CTC DCS","CTC DCS Type","Mute Code","Busy Lock","Demodulation","Tail Tone","Scrambler","Bandwidth","Offset"];isNODE&&(module.exports={MODEL:MODEL,converterParaModelo:converterParaModelo}),"undefined"!=typeof globalThis&&(globalThis.radioModels={...globalThis.radioModels||{},rt4d:{model:MODEL,converterParaModelo:converterParaModelo}},"undefined"!=typeof window&&(window.radioModels=globalThis.radioModels));